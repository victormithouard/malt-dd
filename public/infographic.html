<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infographic: The State of FMS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* --- CSS & LAYOUT UTILITIES --- */
        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
            overflow-x: hidden;
        }

        /* Chart Container Strict Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            /* Max width constraint */
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            /* Base height */
            max-height: 500px;
            /* Max height constraint */
        }

        @media (max-width: 768px) {
            .chart-container {
                height: 300px;
            }
        }

        /* Material Design Cards */
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Gradient Text & Backgrounds */
        .text-gradient {
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-image: linear-gradient(135deg, #2563EB, #06B6D4);
        }

        .bg-gradient-hero {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }

        /* Interactive Modal */
        .modal-enter {
            opacity: 0;
            transform: scale(0.95);
        }

        .modal-enter-active {
            opacity: 1;
            transform: scale(1);
            transition: opacity 300ms, transform 300ms;
        }

        .modal-exit {
            opacity: 1;
            transform: scale(1);
        }

        .modal-exit-active {
            opacity: 0;
            transform: scale(0.95);
            transition: opacity 200ms, transform 200ms;
        }

        /* Typing Cursor */
        .typing-cursor::after {
            content: '|';
            animation: blink 1s step-start infinite;
        }

        @keyframes blink {
            50% {
                opacity: 0;
            }
        }
    </style>
    <!-- Chosen Palette: "Vibrant Tech" (Blue/Cyan/Amber) -->
    <!-- Application Structure Plan:
         1. Hero Section: Title & Big Stats (Hook).
         2. Landscape Section: 4 Lane Grid (Organize).
         3. Analysis Section: Bubble Matrix & Radar Chart (Compare/Relationships).
         4. Player Section: Detailed Cards with GTM Generator (Inform/Interact).
         5. Outlook Section: Future Trends (Change).
         Rationale: Narrative flow from macro market structure to micro player strategy.
    -->
    <!-- Visualization & Content Choices:
         1. Landscape: Styled HTML Cards (Organize) -> Best for text-heavy categories.
         2. Competitive Matrix: Chart.js Bubble (Relationships) -> Standard for Price vs Moat.
         3. Capabilities: Chart.js Radar (Compare) -> Best for multi-axial scoring (Malt vs SAP vs Upwork).
         4. GTM Strategy: Interactive JS Modal (Inform) -> Engages user to "generate" insights.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>

<body>

    <!-- HERO SECTION -->
    <header class="bg-gradient-hero text-white pt-20 pb-24 px-6 relative overflow-hidden">
        <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-500 via-cyan-400 to-blue-600"></div>
        <div class="container mx-auto max-w-6xl text-center relative z-10 animate-fade-in">
            <span
                class="inline-block py-1 px-3 rounded-full bg-blue-900 border border-blue-700 text-cyan-400 text-xs font-bold tracking-wider mb-4">MARKET
                INTELLIGENCE</span>
            <h1 class="text-4xl md:text-6xl font-extrabold mb-6 tracking-tight">The Freelancer Management System
                <br><span class="text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-300">Sector
                    Evolution</span>
            </h1>
            <p class="text-lg md:text-xl text-slate-300 max-w-3xl mx-auto leading-relaxed">
                The market is bifurcating. <strong class="text-white">Legacy VMS</strong> is fighting <strong
                    class="text-white">Agile FMS</strong> in the US, while <strong class="text-white">Malt</strong>
                pioneers a consultant-first model in Europe. The new currency is not just workflow, but <em>compliance
                    indemnification</em>.
            </p>
        </div>

        <!-- Big Number Stats (Grid) -->
        <div class="container mx-auto max-w-5xl mt-16 grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in"
            style="animation-delay: 0.2s;">
            <div class="bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl p-6 text-center">
                <div class="text-4xl font-bold text-cyan-400 mb-1">High</div>
                <div class="text-sm text-slate-400 uppercase tracking-widest">Regulatory Risk</div>
                <p class="text-xs text-slate-500 mt-2">Driven by US DOL & EU Platform Directive</p>
            </div>
            <div class="bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl p-6 text-center">
                <div class="text-4xl font-bold text-blue-400 mb-1">Counter</div>
                <div class="text-sm text-slate-400 uppercase tracking-widest">Cyclicality</div>
                <p class="text-xs text-slate-500 mt-2">Contractors replace FTEs in recessions</p>
            </div>
            <div class="bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl p-6 text-center">
                <div class="text-4xl font-bold text-amber-400 mb-1">3rd Way</div>
                <div class="text-sm text-slate-400 uppercase tracking-widest">European Model</div>
                <p class="text-xs text-slate-500 mt-2">Malt's "Open Garden" vs US "Walled Garden"</p>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT CONTAINER -->
    <main class="container mx-auto max-w-6xl px-4 -mt-10 relative z-20 space-y-24 pb-20">

        <!-- SECTION 1: THE LANDSCAPE (LANES) -->
        <section>
            <div class="bg-white rounded-2xl shadow-xl p-8 md:p-12">
                <div class="mb-10 border-l-4 border-blue-600 pl-4">
                    <h2 class="text-3xl font-bold text-slate-800">1. Unit of Competition</h2>
                    <p class="text-slate-500 mt-2">The sector is structured into four distinct strategic lanes. Players
                        rarely cross lanes successfully without M&A.</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <!-- Core FMS -->
                    <div
                        class="p-6 bg-slate-50 rounded-xl border border-slate-200 hover:border-blue-400 transition cursor-default">
                        <div class="text-4xl mb-4">üèóÔ∏è</div>
                        <h3 class="font-bold text-lg text-slate-800">Core FMS</h3>
                        <p class="text-xs text-blue-600 font-bold uppercase mb-2">Infrastructure</p>
                        <p class="text-sm text-slate-600">Pure workflow software. Assignment, payment, and rating
                            engines. Agnostic to where talent comes from.</p>
                        <div class="mt-4 pt-4 border-t border-slate-200">
                            <span class="text-xs font-semibold text-slate-500">Leader:</span>
                            <span class="text-xs font-bold text-slate-800">ADP WorkMarket</span>
                        </div>
                    </div>
                    <!-- Marketplace -->
                    <div
                        class="p-6 bg-slate-50 rounded-xl border border-slate-200 hover:border-purple-400 transition cursor-default">
                        <div class="text-4xl mb-4">üåç</div>
                        <h3 class="font-bold text-lg text-slate-800">Marketplace</h3>
                        <p class="text-xs text-purple-600 font-bold uppercase mb-2">Distribution</p>
                        <p class="text-sm text-slate-600">Aggregators of talent. They monetize access (take-rate) rather
                            than just software seats.</p>
                        <div class="mt-4 pt-4 border-t border-slate-200">
                            <span class="text-xs font-semibold text-slate-500">Leader:</span>
                            <span class="text-xs font-bold text-slate-800">Upwork / Malt (EU)</span>
                        </div>
                    </div>
                    <!-- Compliance -->
                    <div
                        class="p-6 bg-slate-50 rounded-xl border border-slate-200 hover:border-teal-400 transition cursor-default">
                        <div class="text-4xl mb-4">‚öñÔ∏è</div>
                        <h3 class="font-bold text-lg text-slate-800">Compliance</h3>
                        <p class="text-xs text-teal-600 font-bold uppercase mb-2">Services Wrapper</p>
                        <p class="text-sm text-slate-600">Indemnification providers. Agent of Record (AOR) services that
                            shield clients from lawsuits.</p>
                        <div class="mt-4 pt-4 border-t border-slate-200">
                            <span class="text-xs font-semibold text-slate-500">Leader:</span>
                            <span class="text-xs font-bold text-slate-800">Deel</span>
                        </div>
                    </div>
                    <!-- Legacy VMS -->
                    <div
                        class="p-6 bg-slate-50 rounded-xl border border-slate-200 hover:border-slate-400 transition cursor-default">
                        <div class="text-4xl mb-4">üè¢</div>
                        <h3 class="font-bold text-lg text-slate-800">Legacy VMS</h3>
                        <p class="text-xs text-slate-500 font-bold uppercase mb-2">Enterprise Ops</p>
                        <p class="text-sm text-slate-600">Heavy procurement software handling total workforce (Agency +
                            Freelance). Complex and rigid.</p>
                        <div class="mt-4 pt-4 border-t border-slate-200">
                            <span class="text-xs font-semibold text-slate-500">Leader:</span>
                            <span class="text-xs font-bold text-slate-800">SAP Fieldglass</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: DATA VISUALIZATION (MATRIX & RADAR) -->
        <section>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

                <!-- Chart 1: Comparative Matrix -->
                <div class="card p-8">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800">2. Competitive Matrix</h2>
                        <p class="text-sm text-slate-500">Comparing Pricing Power vs. Moat Durability. <br><span
                                class="text-blue-600">Top Right</span> is the "Winner's Corner".</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="bubbleChart"></canvas>
                    </div>
                    <div class="mt-4 flex flex-wrap gap-4 justify-center text-xs text-slate-500">
                        <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-blue-500 mr-1"></span>Core
                        </div>
                        <div class="flex items-center"><span
                                class="w-3 h-3 rounded-full bg-purple-500 mr-1"></span>Marketplace</div>
                        <div class="flex items-center"><span
                                class="w-3 h-3 rounded-full bg-slate-500 mr-1"></span>Legacy</div>
                    </div>
                </div>

                <!-- Chart 2: The Trade-off Triangle (Radar) -->
                <div class="card p-8">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-slate-800">3. The Trade-off Triangle</h2>
                        <p class="text-sm text-slate-500">How distinct player types sacrifice one attribute to maximize
                            another. <br><strong>Malt</strong> (Quality) vs <strong>Upwork</strong> (Speed) vs
                            <strong>SAP</strong> (Compliance).
                        </p>
                    </div>
                    <div class="chart-container">
                        <canvas id="radarChart"></canvas>
                    </div>
                    <div class="mt-4 text-center">
                        <p class="text-xs text-slate-400 italic">Scores are qualitative estimates based on dossier
                            analysis.</p>
                    </div>
                </div>

            </div>
        </section>

        <!-- SECTION 3: PLAYER ATLAS & GTM GENERATOR -->
        <section>
            <div class="mb-10 border-l-4 border-cyan-500 pl-4">
                <h2 class="text-3xl font-bold text-slate-800">4. Strategic Player Atlas</h2>
                <p class="text-slate-500 mt-2">Deep dive into key players. Click <strong>"Generate GTM"</strong> to
                    simulate their tactical playbook.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8" id="player-grid">
                <!-- Rendered via JS -->
            </div>
        </section>

        <!-- SECTION 4: FUTURE REGIME -->
        <section class="bg-slate-900 rounded-3xl p-10 md:p-16 text-white relative overflow-hidden">
            <!-- Decorative circle -->
            <div class="absolute -top-24 -right-24 w-64 h-64 bg-cyan-500 rounded-full opacity-10 blur-3xl"></div>

            <div class="relative z-10 grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div>
                    <h2 class="text-3xl md:text-4xl font-bold mb-6">5. Regime & Catalysts</h2>
                    <p class="text-slate-300 mb-8 leading-relaxed">
                        The "Wild West" era of freelancing is over. The next 10 years will be defined by
                        <strong>Algorithmic Compliance</strong> and <strong>Direct Sourcing</strong>.
                    </p>
                    <div class="space-y-6">
                        <div class="flex items-start">
                            <div class="bg-blue-600/20 p-3 rounded-lg mr-4 text-2xl">ü§ñ</div>
                            <div>
                                <h4 class="font-bold text-blue-400">AI Displacement</h4>
                                <p class="text-sm text-slate-400 mt-1">Generative AI is shifting demand from "Content
                                    Writers" to "AI Trainers/Editors". Platforms must re-taxonomy rapidly.</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="bg-amber-600/20 p-3 rounded-lg mr-4 text-2xl">üìâ</div>
                            <div>
                                <h4 class="font-bold text-amber-400">Cost-Cutting Supercycle</h4>
                                <p class="text-sm text-slate-400 mt-1">Global recessionary pressure forces Enterprise to
                                    swap FTE headcount for variable contractor opex.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Watchlist Card -->
                <div class="bg-white/5 border border-white/10 rounded-2xl p-8 backdrop-blur-sm">
                    <h3 class="text-xl font-bold text-white mb-6 border-b border-white/10 pb-4">Investable Watchlist
                    </h3>
                    <ul class="space-y-4">
                        <li class="flex justify-between items-center">
                            <span class="text-slate-300">Direct Sourcing Ratio</span>
                            <span class="text-cyan-400 font-bold">‚Üó Rising</span>
                        </li>
                        <li class="flex justify-between items-center">
                            <span class="text-slate-300">AOR Attach Rate</span>
                            <span class="text-cyan-400 font-bold">‚Üó Critical</span>
                        </li>
                        <li class="flex justify-between items-center">
                            <span class="text-slate-300">Platform Take-Rates</span>
                            <span class="text-red-400 font-bold">‚Üò Compressing</span>
                        </li>
                        <li class="flex justify-between items-center">
                            <span class="text-slate-300">Global Payroll M&A</span>
                            <span class="text-amber-400 font-bold">‚ö† High Prob</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

    </main>

    <!-- FOOTER -->
    <footer class="bg-slate-50 border-t border-slate-200 py-12 text-center">
        <p class="text-slate-400 text-sm">Generated for Investor Review | Data Sources: ADP, SAP, Upwork Filings</p>
    </footer>

    <!-- GTM STRATEGY MODAL -->
    <div id="gtm-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-slate-900/80 backdrop-blur-sm transition-opacity opacity-0" id="modal-backdrop"
            onclick="closeGTMModal()"></div>

        <!-- Modal Content -->
        <div class="bg-white w-full max-w-2xl rounded-2xl shadow-2xl relative z-10 transform scale-95 opacity-0 transition-all duration-300 overflow-hidden flex flex-col max-h-[90vh]"
            id="modal-content">

            <!-- Header -->
            <div class="bg-slate-900 p-6 flex justify-between items-center">
                <div>
                    <h3 class="text-white font-bold text-xl">Strategy Simulator</h3>
                    <p class="text-slate-400 text-xs uppercase tracking-wider">AI-Generated Playbook</p>
                </div>
                <button onclick="closeGTMModal()"
                    class="text-slate-400 hover:text-white transition text-2xl">&times;</button>
            </div>

            <!-- Body (Scrollable) -->
            <div class="p-8 overflow-y-auto">

                <!-- Loading State -->
                <div id="gtm-loading" class="flex flex-col items-center justify-center py-12">
                    <div class="w-16 h-16 border-4 border-blue-100 border-t-blue-600 rounded-full animate-spin mb-6">
                    </div>
                    <p class="text-slate-600 font-medium text-lg">Synthesizing Market Data...</p>
                    <p class="text-slate-400 text-sm mt-2 typing-cursor" id="loading-text">Analyzing moat durability...
                    </p>
                </div>

                <!-- Result State -->
                <div id="gtm-result" class="hidden space-y-8">
                    <div class="flex items-center space-x-4">
                        <span id="modal-player-badge"
                            class="px-3 py-1 rounded text-xs font-bold bg-blue-100 text-blue-800 uppercase">Player</span>
                        <h2 id="modal-player-name" class="text-2xl font-bold text-slate-800">Player Name</h2>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-slate-50 p-5 rounded-xl border border-slate-200">
                            <div class="text-xs font-bold text-slate-400 uppercase mb-2">North Star</div>
                            <div id="gtm-north-star" class="font-bold text-slate-800 text-lg leading-tight">Strategy
                            </div>
                        </div>
                        <div class="bg-slate-50 p-5 rounded-xl border border-slate-200">
                            <div class="text-xs font-bold text-slate-400 uppercase mb-2">Attack Vector</div>
                            <div id="gtm-vector" class="font-medium text-blue-600">Vector</div>
                        </div>
                    </div>

                    <div>
                        <h4 class="font-bold text-slate-800 mb-4 border-b border-slate-100 pb-2">Tactical Execution</h4>
                        <ul id="gtm-tactics" class="space-y-3">
                            <!-- Injected -->
                        </ul>
                    </div>

                    <div class="bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg flex items-start">
                        <span class="text-2xl mr-3">üöÄ</span>
                        <div>
                            <h4 class="font-bold text-amber-900 text-sm">Next Best Action</h4>
                            <p id="gtm-action" class="text-amber-800 text-sm mt-1">Action</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="bg-slate-50 p-4 border-t border-slate-200 text-right">
                <button onclick="closeGTMModal()"
                    class="px-5 py-2 bg-white border border-slate-300 text-slate-700 rounded-lg hover:bg-slate-50 transition font-medium text-sm">Close</button>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- DATASET ---
        const players = [
            {
                name: 'Malt',
                role: 'Marketplace (EU)',
                desc: 'European leader for high-skilled consultants. Replaces agencies.',
                moats: ['Local Network Effects', 'EU Compliance'],
                color: 'purple',
                gtm: {
                    northStar: "The Anti-Agency",
                    vector: "DACH Region Enterprise",
                    tactics: ["Replace 'Preferred Vendor Lists' with private talent pools.", "Direct sales to CIOs, bypassing procurement.", "Leverage GDPR indemnification as primary wedge."],
                    action: "Launch 'Consultant Cost Savings' calculator campaign."
                }
            },
            {
                name: 'ADP WorkMarket',
                role: 'Core FMS',
                desc: 'Pure-play FMS integrated into payroll. Strong in Field Services.',
                moats: ['ADP Integration', 'Payment Rails'],
                color: 'blue',
                gtm: {
                    northStar: "Payroll-Connected Workforce",
                    vector: "Existing ADP Clients",
                    tactics: ["Cross-sell FMS as a payroll module.", "Bundle fees into multi-year renewals.", "Unified 1099/W2 reporting dashboard."],
                    action: "In-app 'Contractor Verification' prompts."
                }
            },
            {
                name: 'Upwork Enterprise',
                role: 'Marketplace (Global)',
                desc: 'Global giant moving upstream with Enterprise Suite.',
                moats: ['Global Liquidity', 'Brand'],
                color: 'purple',
                gtm: {
                    northStar: "End-to-End Talent Lifecycle",
                    vector: "Fortune 500 HR",
                    tactics: ["De-emphasize bidding wars.", "Sell 'BYO Talent' compliance tools.", "White-glove scouting services."],
                    action: "Remote-first tech company acquisition campaign."
                }
            },
            {
                name: 'SAP Fieldglass',
                role: 'Legacy VMS',
                desc: 'Procurement behemoth. Complex, rigid, robust.',
                moats: ['Entrenchment', 'Global Scope'],
                color: 'slate',
                gtm: {
                    northStar: "Total Workforce Visibility",
                    vector: "Global 2000 CPOs",
                    tactics: ["Push SOW visibility.", "Leverage S/4HANA migration events.", "Focus on audit trails over UX."],
                    action: "Exclusive C-Suite 'Future of Work' summits."
                }
            },
            {
                name: 'Deel',
                role: 'Compliance',
                desc: 'EOR unicorn adding FMS layers. Fast & Aggressive.',
                moats: ['Legal Infrastructure', 'Speed'],
                color: 'teal',
                gtm: {
                    northStar: "Hire Anyone, Instantly",
                    vector: "High-Growth Scaleups",
                    tactics: ["Bundle FMS free with EOR.", "Viral content marketing.", "Speed as the ultimate feature."],
                    action: "Acquire local payroll engines."
                }
            },
            {
                name: 'Field Nation',
                role: 'Core FMS (Niche)',
                desc: 'Dominant platform for on-site technicians.',
                moats: ['Niche Network', 'Geo-fencing'],
                color: 'blue',
                gtm: {
                    northStar: "OS for Field Services",
                    vector: "Managed Service Providers",
                    tactics: ["Deep API integration with ServiceNow.", "Technician credentialing passport.", "Expand to adjacent trades."],
                    action: "Partnership with Hardware OEMs."
                }
            }
        ];

        // --- CHART 1: BUBBLE MATRIX (Price vs Moat) ---
        // Label processing helper
        function splitLabel(label) {
            if (typeof label === 'string' && label.length > 16) {
                return label.split(' ');
            }
            return label;
        }

        const bubbleCtx = document.getElementById('bubbleChart').getContext('2d');
        const bubbleChart = new Chart(bubbleCtx, {
            type: 'bubble',
            data: {
                datasets: [{
                    label: 'Players',
                    data: [
                        { x: 7.5, y: 7.5, r: 15, label: 'Malt (EU)', type: 'Marketplace' },
                        { x: 7, y: 8, r: 18, label: 'ADP WorkMarket', type: 'Core' },
                        { x: 8, y: 5, r: 25, label: 'Upwork Ent.', type: 'Marketplace' },
                        { x: 9, y: 9, r: 30, label: 'SAP Fieldglass', type: 'Legacy' },
                        { x: 8, y: 8, r: 15, label: 'Deel', type: 'Compliance' },
                        { x: 6, y: 7, r: 12, label: 'Field Nation', type: 'Core' }
                    ],
                    backgroundColor: (ctx) => {
                        const type = ctx.raw?.type;
                        if (type === 'Core') return 'rgba(59, 130, 246, 0.7)'; // Blue
                        if (type === 'Marketplace') return 'rgba(168, 85, 247, 0.7)'; // Purple
                        if (type === 'Legacy') return 'rgba(100, 116, 139, 0.7)'; // Slate
                        return 'rgba(20, 184, 166, 0.7)'; // Teal
                    },
                    borderColor: 'white',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            title: (items) => {
                                const label = items[0].raw.label;
                                return Array.isArray(splitLabel(label)) ? splitLabel(label).join(' ') : label;
                            },
                            label: (ctx) => `Price Power: ${ctx.raw.x}, Moat: ${ctx.raw.y}`
                        },
                        backgroundColor: '#0f172a',
                        padding: 12
                    }
                },
                scales: {
                    x: {
                        title: { display: true, text: 'Pricing Power / Value Capture' },
                        min: 4, max: 10,
                        grid: { color: '#f1f5f9' }
                    },
                    y: {
                        title: { display: true, text: 'Moat Durability' },
                        min: 4, max: 10,
                        grid: { color: '#f1f5f9' }
                    }
                }
            }
        });

        // --- CHART 2: RADAR CHART (Capabilities) ---
        const radarCtx = document.getElementById('radarChart').getContext('2d');
        const radarChart = new Chart(radarCtx, {
            type: 'radar',
            data: {
                labels: ['Compliance Risk', 'Speed to Fill', 'Talent Quality', 'Global Reach', 'UX / Ease'],
                datasets: [
                    {
                        label: 'Malt (EU)',
                        data: [9, 7, 9, 5, 8],
                        borderColor: '#a855f7', // Purple
                        backgroundColor: 'rgba(168, 85, 247, 0.2)',
                        borderWidth: 2
                    },
                    {
                        label: 'Upwork',
                        data: [5, 9, 6, 9, 8],
                        borderColor: '#2563eb', // Blue
                        backgroundColor: 'rgba(37, 99, 235, 0.2)',
                        borderWidth: 2
                    },
                    {
                        label: 'SAP Fieldglass',
                        data: [10, 4, 7, 10, 3],
                        borderColor: '#64748b', // Slate
                        backgroundColor: 'rgba(100, 116, 139, 0.2)',
                        borderWidth: 2
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' },
                    tooltip: {
                        callbacks: {
                            title: function (tooltipItems) {
                                const item = tooltipItems[0];
                                let label = item.chart.data.labels[item.dataIndex];
                                if (Array.isArray(label)) return label.join(' ');
                                return label;
                            }
                        }
                    }
                },
                scales: {
                    r: {
                        angleLines: { color: '#e2e8f0' },
                        grid: { color: '#e2e8f0' },
                        pointLabels: {
                            font: { size: 11, weight: 'bold' },
                            color: '#475569'
                        },
                        suggestedMin: 0,
                        suggestedMax: 10
                    }
                }
            }
        });

        // --- RENDER PLAYER GRID ---
        const grid = document.getElementById('player-grid');
        grid.innerHTML = players.map((p, idx) => {
            const badgeColors = {
                blue: 'bg-blue-100 text-blue-800',
                purple: 'bg-purple-100 text-purple-800',
                slate: 'bg-slate-100 text-slate-800',
                teal: 'bg-teal-100 text-teal-800'
            };
            return `
            <div class="card p-6 flex flex-col h-full border-t-4 border-${p.color}-500">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="font-bold text-xl text-slate-800">${p.name}</h3>
                    <span class="px-2 py-1 rounded text-xs font-bold uppercase ${badgeColors[p.color]}">${p.role.split(' ')[0]}</span>
                </div>
                <p class="text-sm text-slate-600 mb-4 flex-grow">${p.desc}</p>
                <div class="mb-6">
                    <span class="text-xs font-bold text-slate-400 uppercase">Moats</span>
                    <div class="flex flex-wrap gap-2 mt-1">
                        ${p.moats.map(m => `<span class="text-xs border border-slate-200 px-2 py-1 rounded text-slate-600">${m}</span>`).join('')}
                    </div>
                </div>
                <button onclick="openGTMModal(${idx})" class="w-full py-3 rounded-lg font-bold text-sm bg-slate-50 text-slate-700 hover:bg-${p.color}-50 hover:text-${p.color}-700 border border-slate-200 transition-colors flex items-center justify-center gap-2 group">
                    <span class="group-hover:scale-110 transition-transform">‚ö°</span> Generate GTM Strategy
                </button>
            </div>
            `;
        }).join('');

        // --- GTM MODAL LOGIC ---
        const modal = document.getElementById('gtm-modal');
        const backdrop = document.getElementById('modal-backdrop');
        const content = document.getElementById('modal-content');
        const loading = document.getElementById('gtm-loading');
        const result = document.getElementById('gtm-result');

        function openGTMModal(index) {
            const player = players[index];
            const modal = document.getElementById('gtm-modal');
            const backdrop = document.getElementById('modal-backdrop');
            const content = document.getElementById('modal-content');
            const loading = document.getElementById('gtm-loading');
            const result = document.getElementById('gtm-result');
            const loadingText = document.getElementById('loading-text');

            // Show Modal
            modal.classList.remove('hidden');
            // Animate In
            requestAnimationFrame(() => {
                backdrop.classList.remove('opacity-0');
                content.classList.remove('scale-95', 'opacity-0');
                content.classList.add('scale-100', 'opacity-100');
            });

            // Reset Logic
            loading.classList.remove('hidden');
            result.classList.add('hidden');

            // Simulation text
            const texts = ["Scanning market lanes...", "Evaluating competitive pressure...", "Formulating attack vectors..."];
            let i = 0;
            const interval = setInterval(() => {
                if (i < texts.length) loadingText.innerText = texts[i++];
            }, 800);

            // Fetch from backend
            fetch('/api/generate-gtm', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ player }),
            })
                .then(response => response.json())
                .then(data => {
                    clearInterval(interval);
                    populateGTM(player, data);
                    loading.classList.add('hidden');
                    result.classList.remove('hidden');
                })
                .catch(error => {
                    clearInterval(interval);
                    console.error('Error:', error);
                    loadingText.innerText = "Error. Please try again.";
                });
        }

        function populateGTM(player, strategy) {
            document.getElementById('modal-player-name').innerText = player.name;
            document.getElementById('modal-player-badge').innerText = player.role;
            document.getElementById('gtm-north-star').innerText = strategy.northStar;
            document.getElementById('gtm-vector').innerText = strategy.vector;
            document.getElementById('gtm-action').innerText = strategy.action;

            document.getElementById('gtm-tactics').innerHTML = strategy.tactics.map(t =>
                `<li class="flex items-start text-sm text-slate-600"><span class="text-blue-500 font-bold mr-2">‚úì</span>${t}</li>`
            ).join('');
        }

        function closeGTMModal() {
            backdrop.classList.add('opacity-0');
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-95', 'opacity-0');

            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

    </script>
</body>

</html>